<html>
<head>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
</head>
<body style="margin:0;padding:0px;overflow:hidden">
<iframe id="frame" style="position:fixed; top:0px; left:0px; bottom:0px; right:0px; width:100%; height:100%; border:none; margin:0; padding:0; overflow:hidden; z-index:999999;" allowfullscreen></iframe>
<script>
/*if (location.protocol != 'https:') {
 location.href = 'https:' + window.location.href.substring(window.location.protocol.length);
}*/
var api_key = 'AIzaSyC_cec0UVnf6e9qfO2j6fKpjmykSH_EJbE';
var rng(a, b) {
  return a + Math.floor(Math.random() * (b - a));
}
$.get('https://docs.google.com/spreadsheets/d/e/2PACX-1vS-a7O8wuUkBCmoyrCZyfJAMPx1zbM8tianwBpnzWD6lP5a8tp4CkGBRfxi2oYJSwRErpUr1n-1sLe1/pub?gid=11&single=true&output=csv', function(data) {
  var rows = data.split('\n');
  var name = '';
  while (name == '') {
    var i = Math.floor(rng(1, rows.length));
    name = rows[i].split(',')[0];
  }
  var q = name + ' gameplay';
  $.get('https://www.googleapis.com/youtube/v3/search?part=snippet&maxResults=1&key=' + api_key + '&q=' + q, function(search_results) {
    console.log(search_results);
    var video_id = search_results.items[0].id.videoId;
    $.get('https://content.googleapis.com/youtube/v3/videos?part=contentDetails&id=' + video_id + '&key=' + api_key, function(video_details) {
      var length = Date.parse(video_details.items[0].contentDetails.duration) / 1000;
      var start = length * rng(1/3, 2/3);
      document.getElementById("frame").src = 'https://www.youtube.com/embed/' + video_id + '?autoplay=1&start=' + start + '&listType=search&list=' + q;
    });
  });
});
</script>
</body>
</html>
